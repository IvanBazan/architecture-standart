### **Название задачи: передача ставок по депозитам в колл-центры** 
### **Автор: Ivan Bazanov**
### **Дата: 21.06.2025**
### **Функциональные требования**

| **№** | **Действующие лица или системы**                                                                               | **Use Case**                                | **Описание** |
| :---: | :------------------------------------------------------------------------------------------------------------- | :------------------------------------------ | :----------- |
|  UC1  | Бэкофис<br>АБС<br>система внешнего колл-центра  | Передача ставок во внешний колл-центр | 1. Бэкофис вносит акутуальные ставки в систему АБС<br>2. АБС по протоколу SMTP отправляет email <br>3. Система внешнего колл-центра проверяет специальную почту для сообщений со ставками и вносит их в систему     |
|  UC2  | Бэкофис<br>АБС<br>система колл-центра банка   | Передача ставок в колл-центр банка  |  1. Бэкофис вносит акутуальные ставки в систему АБС<br>2. АБС отправляет в kafka топик актуальные ставки <br>3. Система колл-центра подписана на топик с сообщениями со ставками, получает акутальные и вносит их в систему |

### **Нефункциональные требования**

| **№** | **Требование**                                                                                                          |
| :---: | :---------------------------------------------------------------------------------------------------------------------- |
|  +R   | + Ограничения (Restrictions)                                                                                            |
|  +R1  | Партнерский колл-центр готов получать ставки файлом. Нет возможности сделать API-вызовы (например, через SFTP-протокол) |



### **Решение**
```markdown
![Диаграмма контекста](/context4.png)
```
```markdown
![Диаграмма контейнеров](/container4.png)
```

 1. Для передачи ставок в банковский колл-центр предлагается использовать реализуемую систему брокера сообщений
    1. При обновлении ставки она отправляется в соответсвующий топик брокера
    2. Система банковского колл центра подписана на данный топик и обновляет данные при получении

 2. В партнерский колл-центр предлагается передавать ставки через файл определённого формата отправляемый на указанный email

### **Альтернативы**
 1. На случай проблемы с подпиской на брокер (трудно настраивать междусерверное взаимодействие, файрволы и пр.) предлагается использовать реализуемый для Интернет-банка API эндпоинт через который передаются данные по актуальным ставкам.
 2. Использование нового Java сервиса АБС для отправки сообщений через smtp 

**Недостатки, ограничения, риски**

1. Потенциальные сложности в банковских междусерверных взаимодействиях при настройке подписки на кафку
2. Email как средство интеграции не самый надёжный метод (проблемы доставки, обработка писем как спама, нет подтверждения обработки)